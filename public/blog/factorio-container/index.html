<!DOCTYPE html>


<html lang="en-US" data-theme="">
<head>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">

<title>Factorio Container - Philip Mallegol-Hansen</title>

<meta name="description" content="A while ago I came to the realization that my Docker knowledge was rather lacking. I had heard of the tool on and off over the years, even completed the quick-start tutorials once or twice, but I had never made a container for a project of my own.">





<link rel="icon" type="image/x-icon" href="https://philip.mallegolhansen.com/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="https://philip.mallegolhansen.com/favicon.png">






    



    



<style>
  body {
    visibility: hidden;
    opacity: 0;
  }
</style>

<noscript>
  <style>
    body {
      visibility: visible;
      opacity: 1;
    }
  </style>
</noscript>




    





    
    
        
    
    

    
        <link rel="stylesheet" href="/css/style.min.44f8240afd8df81b52565c4119ac5ae247776c77fc6d7ccf6e101a6c98abfa7a.css" integrity="sha256-RPgkCv2N&#43;BtSVlxBGaxa4kd3bHf8bXzPbhAabJir&#43;no=">
    





    





    
    
        
    
    

    
        <link rel="stylesheet" href="/css/style.min.c4c04b3ef88e3d619ad4c7ee5e03048422bc55c4fefdc1f07657c1133670aa22.css" integrity="sha256-xMBLPviOPWGa1MfuXgMEhCK8VcT&#43;/cHwdlfBEzZwqiI=">
    





    





    
    
        
    
    

    
        <link rel="stylesheet" href="/css/style.min.21c5d8fe0a79d623b0adc1ce4bd4f6dd2c05cd939c9aaaa966ba7186b1464f4d.css" integrity="sha256-IcXY/gp51iOwrcHOS9T23SwFzZOcmqqpZrpxhrFGT00=">
    












    

    





    
    
        
    
    

    
        <script src="/js/script.min.08f04d96386c73c9bf4d160333f8f448c05a6e01c06770542ee0e013954ce930.js" type="text/javascript" charset="utf-8" integrity="sha256-CPBNljhsc8m/TRYDM/j0SMBabgHAZ3BULuDgE5VM6TA="></script>
    















    

<script async defer data-website-id="f516ccf4-b76a-42cd-a2e1-7e95426f57e4" data-cache="false" data-do-not-track="false" src="https://us.umami.is/script.js"></script>






    
</head>
<body>
    <a class="skip-main" href="#main">Skip to main content</a>
    <div class="container">
        <header class="common-header">
            
                <div class="header-top">
    <div class="header-top-left">
        <h1 class="site-title noselect">
    <a href="/">Philip Mallegol-Hansen</a>
</h1>

        



    



    



    
        <div class="theme-switcher">
            <span class="inline-svg">

    


    
    
    
    
    

    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-sun-high"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z" /><path d="M6.343 17.657l-1.414 1.414" /><path d="M6.343 6.343l-1.414 -1.414" /><path d="M17.657 6.343l1.414 -1.414" /><path d="M17.657 17.657l1.414 1.414" /><path d="M4 12h-2" /><path d="M12 4v-2" /><path d="M20 12h2" /><path d="M12 20v2" /></svg>


</span>

        </div>
    

    <script>
        const STORAGE_KEY = 'user-color-scheme'
        const defaultTheme = "auto"

        let currentTheme
        let switchButton
        let autoDefinedScheme = window.matchMedia('(prefers-color-scheme: dark)')

        function switchTheme(e) {
            currentTheme = (currentTheme === 'dark') ? 'light' : 'dark';
            if (localStorage) localStorage.setItem(STORAGE_KEY, currentTheme);
            document.documentElement.setAttribute('data-theme', currentTheme);
            changeGiscusTheme(currentTheme);
            document.body.dispatchEvent(new CustomEvent(currentTheme + "-theme-set"));
        }

        const autoChangeScheme = e => {
            currentTheme = e.matches ? 'dark' : 'light'
            document.documentElement.setAttribute('data-theme', currentTheme);
            changeGiscusTheme(currentTheme);
            document.body.dispatchEvent(new CustomEvent(currentTheme + "-theme-set"));
        }

        document.addEventListener('DOMContentLoaded', function () {
            switchButton = document.querySelector('.theme-switcher')
            currentTheme = detectCurrentScheme()

            if (currentTheme === 'auto') {
                autoChangeScheme(autoDefinedScheme);
                autoDefinedScheme.addListener(autoChangeScheme);
            } else {
                document.documentElement.setAttribute('data-theme', currentTheme)
            }

            if (switchButton) {
                switchButton.addEventListener('click', switchTheme, false)
            }

            showContent();
        })

        function detectCurrentScheme() {
            if (localStorage !== null && localStorage.getItem(STORAGE_KEY)) {
                return localStorage.getItem(STORAGE_KEY)
            }
            if (defaultTheme) {
                return defaultTheme
            }
            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        }

        function showContent() {
            document.body.style.visibility = 'visible';
            document.body.style.opacity = 1;
        }

        function changeGiscusTheme (theme) {
            function sendMessage(message) {
              const iframe = document.querySelector('iframe.giscus-frame');
              if (!iframe) return;
              iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
            }

            sendMessage({
              setConfig: {
                theme: theme
              }
            });
        }
    </script>


        <ul class="social-icons noselect">


    
        <li>
            <a href="mailto:philip@mallegolhansen.com" title="Email" rel="me">
            <span class="inline-svg">

    


    
    
    
    
    

    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-mail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z" /><path d="M3 7l9 6l9 -6" /></svg>


</span>

            </a>
        </li>
    

    
        <li>
            <a href="https://github.com/Hanse00" title="Github" rel="me">
            <span class="inline-svg">

    


    
    
    
    
    

    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-github"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" /></svg>


</span>

            </a>
        </li>
    

    
        <li>
            <a href="https://www.linkedin.com/in/philip-mallegol-hansen-534b1a91/" title="Linkedin" rel="me">
            <span class="inline-svg">

    


    
    
    
    
    

    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-linkedin"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z" /><path d="M8 11l0 5" /><path d="M8 8l0 .01" /><path d="M12 16l0 -5" /><path d="M16 16v-3a2 2 0 0 0 -4 0" /></svg>


</span>

            </a>
        </li>
    

    
        <li>
            <a href="https://mastodon.mallegolhansen.com/@philip" title="Mastodon" rel="me">
            <span class="inline-svg">

    


    
    
    
    
    

    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-mastodon"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.648 15.254c-1.816 1.763 -6.648 1.626 -6.648 1.626a18.262 18.262 0 0 1 -3.288 -.256c1.127 1.985 4.12 2.81 8.982 2.475c-1.945 2.013 -13.598 5.257 -13.668 -7.636l-.026 -1.154c0 -3.036 .023 -4.115 1.352 -5.633c1.671 -1.91 6.648 -1.666 6.648 -1.666s4.977 -.243 6.648 1.667c1.329 1.518 1.352 2.597 1.352 5.633s-.456 4.074 -1.352 4.944z" /><path d="M12 11.204v-2.926c0 -1.258 -.895 -2.278 -2 -2.278s-2 1.02 -2 2.278v4.722m4 -4.722c0 -1.258 .895 -2.278 2 -2.278s2 1.02 2 2.278v4.722" /></svg>


</span>

            </a>
        </li>
    

    
        <li>
            <a href="https://steamcommunity.com/id/hanse00" title="Steam" rel="me">
            <span class="inline-svg">

    


    
    
    
    
    

    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-steam"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M16.5 5a4.5 4.5 0 1 1 -.653 8.953l-4.347 3.009l0 .038a3 3 0 0 1 -2.824 3l-.176 0a3 3 0 0 1 -2.94 -2.402l-2.56 -1.098v-3.5l3.51 1.755a2.989 2.989 0 0 1 2.834 -.635l2.727 -3.818a4.5 4.5 0 0 1 4.429 -5.302z" /><circle cx="16.5" cy="9.5" r="1" fill="currentColor" /></svg>


</span>

            </a>
        </li>
    






    <li>
            <a href="/index.xml" title="RSS" rel="me">
            <span class="inline-svg">

    


    
    
    
    
    

    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-rss"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M4 4a16 16 0 0 1 16 16" /><path d="M4 11a9 9 0 0 1 9 9" /></svg>


</span>

            </a>
        </li>
    

</ul>

    </div>
    <div class="header-top-right">

    </div>
</div>


    <nav class="noselect">
        
        
        <a class="" href="https://philip.mallegolhansen.com/" title="">Home</a>
        
        <a class="" href="https://philip.mallegolhansen.com/now" title="">Now</a>
        
        <a class="" href="https://philip.mallegolhansen.com/tags/" title="">Tags</a>
        
    </nav>








            
        </header>
        <main id="main" tabindex="-1">
            
    

    <article class="post h-entry">
        <div class="post-header">
            <header>
                <h1 class="p-name post-title">Factorio Container</h1>
                

            </header>
            

    



<div class="post-info noselect">
    
        <div class="post-date dt-published">
            <time datetime="2020-05-14">May 14 2020 - 16:33 -0700</time>
            
        </div>
    

    <a class="post-hidden-url u-url" href="/blog/factorio-container/">/blog/factorio-container/</a>
    <a href="https://philip.mallegolhansen.com/" class="p-name p-author post-hidden-author h-card" rel="me">map[name:Philip Mallegol-Hansen]</a>


    <div class="post-taxonomies">
        
        
            <ul class="post-tags">
                
                    
                    <li><a href="/tags/technology/">#Technology</a></li>
                
                    
                    <li><a href="/tags/gaming/">#Gaming</a></li>
                
                    
                    <li><a href="/tags/factorio/">#Factorio</a></li>
                
                    
                    <li><a href="/tags/container/">#Container</a></li>
                
            </ul>
        
        
    </div>
</div>

        </div>
        

  
  
    
  






<script>
  var toc = document.querySelector(".toc");
  if (toc) {
    toc.addEventListener("click", function () {
      if (event.target.tagName !== "A") {
        event.preventDefault();
        if (this.open) {
          this.open = false;
          this.classList.remove("expanded");
        } else {
          this.open = true;
          this.classList.add("expanded");
        }
      }
    });
  }
</script>

        <div class="content e-content">
            <p>A while ago I came to the realization that my Docker knowledge was rather lacking. I had heard of the tool on and off over the years, even completed the quick-start tutorials once or twice, but I had never made a container for a project of my own.</p>
<p>Coincidentally, a group of friends were trying to organize some online gaming around the same time. We had decided that we wanted to play the excellent strategy / simulation game, <a href="https://factorio.com/">Factorio</a>.</p>
<p>A Factorio server is a simple binary that runs on Linux, but it takes a bit of setup to get right. I decided that this was the perfect candidate for me to jump into my container adventure.</p>
<p>The fruits of my labor are available on both <a href="https://github.com/Hanse00/Factorio-Container">GitHub</a> and <a href="https://hub.docker.com/repository/docker/hanse01/factorio-container">Docker Hub</a>, if that’s the kind of thing that interests you.</p>
<p>For the rest of the article, I’m going to go into some of the struggles I had and the lessons that I learned, which may help you in your travels.</p>
<h2 id="why" >
<div>
    <a href="#why">
        #
    </a>
    Why?
</div>
</h2>
<p>I think it’s worth addressing the why first. Why did I make my own container, when there are already <a href="https://github.com/search?q=factorio%20docker">125+ results for “factorio docker” on GitHub</a>?</p>
<p>There are two primary reasons:</p>
<ul>
<li>
<p>I wanted to learn to make my own Docker container. Regardless of if the result ends up being of value to anyone, including myself. It was a learning experience first and foremost. And I’m now comfortable saying “I know how to use Docker”, even if I’ll have to look up the details along the way.</p>
</li>
<li>
<p>The most popular Docker container for Factorio out there, made by the <a href="https://github.com/factoriotools/factorio-docker">factoriotools team</a>, just didn’t quite work the way I wanted it to. To their defense, throughout my journey I learned that some of the reasons for that are out of their control. And in fact, my own container now has some of the same shortcomings. This just goes to show that I had things to learn about Docker.</p>
</li>
</ul>
<h2 id="what" >
<div>
    <a href="#what">
        #
    </a>
    What?
</div>
</h2>
<p>So what exactly does the container do? On the surface it’s pretty simple.</p>
<p>The Factorio developers have done an amazing job supporting Linux as a first class platform, both for playing the game (Which has a native Linux client) and for hosting the headless server. So all we need to do, is download the headless server binary and run it.</p>
<p>As always, there are a few kinks: Making sure our container has curl for downloading the game, creating a separate user for running the server (rather than running everything as root), and perhaps the most complicated part: file permissions.</p>
<p>The beauty of the system, is that I can point you to my <a href="https://github.com/Hanse00/Factorio-Container/blob/master/Dockerfile">Dockerfile</a> for all the exact details of the process, thereby making it self-documenting as long as you are familiar with the regular Linux commands such as apt-get, mkdir, chown, chmod, etc.</p>
<h2 id="pain-points" >
<div>
    <a href="#pain-points">
        #
    </a>
    Pain Points
</div>
</h2>
<p>Overall the process of creating a Docker container was actually surprisingly smooth. Having managed bare metal Linux servers in my past, it felt like a natural evolution.
That being said, nothing is perfect.</p>
<p>The one major pain point in this project, was POSIX file permissions.</p>
<p>For anyone who has worked with Linux in the past, this might not come as a huge surprise, but Docker complicates this a bit. It does so by abstracting away the volume, and thereby the permissions, from where they are being used.</p>
<p>For those not familiar, let’s take a step back:</p>
<p>Linux and similar operating systems have a shared way of handling file permissions. At a higher level, this breaks down into: Which user owns a file / directory, which group owns a file / directory, which permissions (of a set of: read, write, and execute) does the owning user have, which permissions do members in the owning group have, and which permissions do everyone else have.</p>
<p>The key part in this context is the user and group who own the file / directory.</p>
<p>No matter what happens to the container, we want the data to stick around. That’s why Docker separates the storage of files onto a “volume” which exists independently of the container that uses it. That also means that the user on our container, which will run the application, does not exist in the context where the volume does.</p>
<h3 id="how-do-we-work-around-that" >
<div>
    <a href="#how-do-we-work-around-that">
        ##
    </a>
    How do we work around that?
</div>
</h3>
<p>There are multiple possible solutions, but none of them feel quite as nice as I’d like.<br>
In the end, I decided to do exactly what the team over at factoriotools did (And so we come full circle).</p>
<p>To be able to configure the file permissions on the volume, we must know which UID the user on the container will have. Therefore, we set the file permissions to a specific numeric UID and configure the container user to always have that UID.<br>
Usually it’s considered bad practice to pin a user to a specific UID, rather than letting the system pick one at creation time, but in this case, we do not seem to have a better choice.</p>
<p>If you know of a more elegant way to handle file permissions in Docker volumes, I’d love to hear it!</p>
<h2 id="lessons-learned" >
<div>
    <a href="#lessons-learned">
        #
    </a>
    Lessons Learned
</div>
</h2>
<p>Although seemingly contradictory, two lessons that are important to keep in mind when starting out a project, especially in a space that’s already occupied by other projects:</p>
<ul>
<li>Others likely had a reason for making the choices they made.</li>
<li>Just because someone else did it that way, doesn’t mean it’s the right way for you to do it.</li>
</ul>
<p>Although in my case, I now realize why those before me picked the path that they did, however, it wasn’t obvious from the beginning that it was the right way to do it. And by not following them blindly, I learned a lot.</p>
<h3 id="document-your-decisions" >
<div>
    <a href="#document-your-decisions">
        ##
    </a>
    Document your decisions
</div>
</h3>
<p>Although code commenting is a highly debated topic, my 2 cents are: Don’t write down what your code is doing (The code is already doing that job), write down why.
That way others will have a chance at understanding why your code does something, that doesn’t look right on the surface.</p>
<h3 id="finish-your-projects" >
<div>
    <a href="#finish-your-projects">
        ##
    </a>
    Finish your projects
</div>
</h3>
<p>Although perhaps a bit meta, it really made a change to my mood once the project had reached my defined finish line.</p>
<p>I have tons of other projects I have worked on over the years, but very few have reached a true completion point.
I’m definitely going to strive to finish more projects in the future, for some definition of finish, and I recommend you do the same.
Keep in mind, finish doesn’t have to mean that you bring it to market and sell to 10 million users. Finish is whatever line you draw in the sand.</p>
        </div>

    </article>

    
    

    
        
        
            <h3 class="read-next-title noselect">Read next</h3>
            <ul class="read-next-posts noselect">
                
                <li><a href="/blog/triple-booting-macos-ubuntu-and-windows/">Triple Booting macOS, Ubuntu, and Windows</a></li>
                
            </ul>
        
    

    

    
        









    

    

    

    

        </main>
        
            <footer class="common-footer noselect">
    
    

    <div class="common-footer-bottom">
        

        <div style="display: flex; align-items: center; gap:8px">
            ©  Philip Mallegol-Hansen,  2025
            
        </div>
        <div style="display:flex;align-items: center">
            
            
            
            
            
            
        </div>
        <div>
            Powered by <a target="_blank" rel="noopener noreferrer" href="https://gohugo.io/">Hugo</a>, theme <a target="_blank" rel="noopener noreferrer" href="https://github.com/Junyi-99/hugo-theme-anubis2">Anubis2</a>.<br>
            

        </div>
    </div>

    <p class="h-card vcard">

    <a href=https://philip.mallegolhansen.com/ class="p-name u-url url fn" rel="me">map[name:Philip Mallegol-Hansen]</a>

    

    
</p>

</footer>

        
    </div>
</body>
</html>
